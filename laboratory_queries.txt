SELECT (SELECT НАЗВАНИЕ
          FROM КОМАНДА
         WHERE КОМАНДА_ID = КОМАНДА_КОМАНДА_ID) AS ХОЗЯИН,
       (SELECT COUNT(*)
          FROM (SELECT *
                  FROM СОБЫТИЕ
                 WHERE МАТЧ_МАТЧ_ID = МАТЧ_ID
                   AND (((ТИП_СОБЫТИ_ТИП_СОБЫТИ_ID = 1 OR
                       ТИП_СОБЫТИ_ТИП_СОБЫТИ_ID = 4) AND
                       ЧЕЛОВЕК_ЧЕЛОВЕК_ID IN
                       (SELECT ЧЕЛОВЕК_ЧЕЛОВЕК_ID
                            FROM ИГРОК_КОМАНДЫ
                           WHERE ИГРОК_КОМАНДЫ.КОМАНДА_КОМАНДА_ID =
                                 МАТЧ.КОМАНДА_КОМАНДА_ID)) OR
                       (ТИП_СОБЫТИ_ТИП_СОБЫТИ_ID = 2 AND
                       ЧЕЛОВЕК_ЧЕЛОВЕК_ID IN
                       (SELECT ЧЕЛОВЕК_ЧЕЛОВЕК_ID
                            FROM ИГРОК_КОМАНДЫ
                           WHERE ИГРОК_КОМАНДЫ.КОМАНДА_КОМАНДА_ID =
                                 МАТЧ.КОМАНДА_КОМАНДА_ID_ИМЕЕТ_ГОСТЯ))))) AS СЧЁТ_ХОЗЯЕВ,
       (SELECT COUNT(*)
          FROM (SELECT *
                  FROM СОБЫТИЕ
                 WHERE МАТЧ_МАТЧ_ID = МАТЧ_ID
                   AND (((ТИП_СОБЫТИ_ТИП_СОБЫТИ_ID = 1 OR
                       ТИП_СОБЫТИ_ТИП_СОБЫТИ_ID = 4) AND
                       ЧЕЛОВЕК_ЧЕЛОВЕК_ID IN
                       (SELECT ЧЕЛОВЕК_ЧЕЛОВЕК_ID
                            FROM ИГРОК_КОМАНДЫ
                           WHERE ИГРОК_КОМАНДЫ.КОМАНДА_КОМАНДА_ID =
                                 МАТЧ.КОМАНДА_КОМАНДА_ID_ИМЕЕТ_ГОСТЯ)) OR
                       (ТИП_СОБЫТИ_ТИП_СОБЫТИ_ID = 2 AND
                       ЧЕЛОВЕК_ЧЕЛОВЕК_ID IN
                       (SELECT ЧЕЛОВЕК_ЧЕЛОВЕК_ID
                            FROM ИГРОК_КОМАНДЫ
                           WHERE ИГРОК_КОМАНДЫ.КОМАНДА_КОМАНДА_ID =
                                 МАТЧ.КОМАНДА_КОМАНДА_ID))))) AS СЧЁТ_ГОСТЕЙ,
       (SELECT НАЗВАНИЕ
          FROM КОМАНДА
         WHERE КОМАНДА_ID = КОМАНДА_КОМАНДА_ID_ИМЕЕТ_ГОСТЯ) AS ГОСТЬ
  FROM МАТЧ














SELECT ROWNUM МЕСТО,
       НАЗВАНИЕ AS КОМАНДА,
       (SELECT COUNT(*)
          FROM (SELECT *
                  FROM СОБЫТИЕ
                 WHERE ((ТИП_СОБЫТИ_ТИП_СОБЫТИ_ID = 1 OR
                       ТИП_СОБЫТИ_ТИП_СОБЫТИ_ID = 4) AND
                       ЧЕЛОВЕК_ЧЕЛОВЕК_ID IN
                       (SELECT ЧЕЛОВЕК_ЧЕЛОВЕК_ID
                           FROM ИГРОК_КОМАНДЫ
                          WHERE ИГРОК_КОМАНДЫ.КОМАНДА_КОМАНДА_ID = КОМАНДА_ID))
                    OR (ТИП_СОБЫТИ_ТИП_СОБЫТИ_ID = 2 AND
                       ЧЕЛОВЕК_ЧЕЛОВЕК_ID NOT IN
                       (SELECT ЧЕЛОВЕК_ЧЕЛОВЕК_ID
                           FROM ИГРОК_КОМАНДЫ
                          WHERE ИГРОК_КОМАНДЫ.КОМАНДА_КОМАНДА_ID = КОМАНДА_ID) AND
                       ((КОМАНДА_ID IN
                       (SELECT КОМАНДА_КОМАНДА_ID
                             FROM МАТЧ
                            WHERE МАТЧ_ID = МАТЧ_МАТЧ_ID)) OR
                       (КОМАНДА_ID IN
                       (SELECT КОМАНДА_КОМАНДА_ID_ИМЕЕТ_ГОСТЯ
                             FROM МАТЧ
                            WHERE МАТЧ_ID = МАТЧ_МАТЧ_ID)))))) AS ЗАБИТО,
       (SELECT COUNT(*)
          FROM (SELECT *
                  FROM СОБЫТИЕ
                 WHERE (ТИП_СОБЫТИ_ТИП_СОБЫТИ_ID = 2 AND
                       ЧЕЛОВЕК_ЧЕЛОВЕК_ID IN
                       (SELECT ЧЕЛОВЕК_ЧЕЛОВЕК_ID
                           FROM ИГРОК_КОМАНДЫ
                          WHERE ИГРОК_КОМАНДЫ.КОМАНДА_КОМАНДА_ID = КОМАНДА_ID))
                    OR ((ТИП_СОБЫТИ_ТИП_СОБЫТИ_ID = 1 OR
                       ТИП_СОБЫТИ_ТИП_СОБЫТИ_ID = 4) AND
                       ЧЕЛОВЕК_ЧЕЛОВЕК_ID NOT IN
                       (SELECT ЧЕЛОВЕК_ЧЕЛОВЕК_ID
                           FROM ИГРОК_КОМАНДЫ
                          WHERE ИГРОК_КОМАНДЫ.КОМАНДА_КОМАНДА_ID = КОМАНДА_ID) AND
                       ((КОМАНДА_ID IN
                       (SELECT КОМАНДА_КОМАНДА_ID
                             FROM МАТЧ
                            WHERE МАТЧ_ID = МАТЧ_МАТЧ_ID)) OR
                       (КОМАНДА_ID IN
                       (SELECT КОМАНДА_КОМАНДА_ID_ИМЕЕТ_ГОСТЯ
                             FROM МАТЧ
                            WHERE МАТЧ_ID = МАТЧ_МАТЧ_ID)))))) AS ПРОПУЩЕНО,
       ((SELECT COUNT(*)
           FROM (SELECT *
                   FROM СОБЫТИЕ
                  WHERE ((ТИП_СОБЫТИ_ТИП_СОБЫТИ_ID = 1 OR
                        ТИП_СОБЫТИ_ТИП_СОБЫТИ_ID = 4) AND
                        ЧЕЛОВЕК_ЧЕЛОВЕК_ID IN
                        (SELECT ЧЕЛОВЕК_ЧЕЛОВЕК_ID
                            FROM ИГРОК_КОМАНДЫ
                           WHERE ИГРОК_КОМАНДЫ.КОМАНДА_КОМАНДА_ID = КОМАНДА_ID))
                     OR (ТИП_СОБЫТИ_ТИП_СОБЫТИ_ID = 2 AND
                        ЧЕЛОВЕК_ЧЕЛОВЕК_ID NOT IN
                        (SELECT ЧЕЛОВЕК_ЧЕЛОВЕК_ID
                            FROM ИГРОК_КОМАНДЫ
                           WHERE ИГРОК_КОМАНДЫ.КОМАНДА_КОМАНДА_ID = КОМАНДА_ID) AND
                        ((КОМАНДА_ID IN
                        (SELECT КОМАНДА_КОМАНДА_ID
                              FROM МАТЧ
                             WHERE МАТЧ_ID = МАТЧ_МАТЧ_ID)) OR
                        (КОМАНДА_ID IN
                        (SELECT КОМАНДА_КОМАНДА_ID_ИМЕЕТ_ГОСТЯ
                              FROM МАТЧ
                             WHERE МАТЧ_ID = МАТЧ_МАТЧ_ID)))))) -
       (SELECT COUNT(*)
           FROM (SELECT *
                   FROM СОБЫТИЕ
                  WHERE (ТИП_СОБЫТИ_ТИП_СОБЫТИ_ID = 2 AND
                        ЧЕЛОВЕК_ЧЕЛОВЕК_ID IN
                        (SELECT ЧЕЛОВЕК_ЧЕЛОВЕК_ID
                            FROM ИГРОК_КОМАНДЫ
                           WHERE ИГРОК_КОМАНДЫ.КОМАНДА_КОМАНДА_ID = КОМАНДА_ID))
                     OR ((ТИП_СОБЫТИ_ТИП_СОБЫТИ_ID = 1 OR
                        ТИП_СОБЫТИ_ТИП_СОБЫТИ_ID = 4) AND
                        ЧЕЛОВЕК_ЧЕЛОВЕК_ID NOT IN
                        (SELECT ЧЕЛОВЕК_ЧЕЛОВЕК_ID
                            FROM ИГРОК_КОМАНДЫ
                           WHERE ИГРОК_КОМАНДЫ.КОМАНДА_КОМАНДА_ID = КОМАНДА_ID) AND
                        ((КОМАНДА_ID IN
                        (SELECT КОМАНДА_КОМАНДА_ID
                              FROM МАТЧ
                             WHERE МАТЧ_ID = МАТЧ_МАТЧ_ID)) OR
                        (КОМАНДА_ID IN
                        (SELECT КОМАНДА_КОМАНДА_ID_ИМЕЕТ_ГОСТЯ
                              FROM МАТЧ
                             WHERE МАТЧ_ID = МАТЧ_МАТЧ_ID))))))) AS РАЗНИЦА,
       ((SELECT COUNT(*) * 3
          FROM МАТЧ
         WHERE (SELECT COUNT(*)
                  FROM (SELECT *
                          FROM СОБЫТИЕ
                         WHERE МАТЧ_МАТЧ_ID = МАТЧ_ID
                           AND (((ТИП_СОБЫТИ_ТИП_СОБЫТИ_ID = 1 OR
                               ТИП_СОБЫТИ_ТИП_СОБЫТИ_ID = 4) AND
                               ЧЕЛОВЕК_ЧЕЛОВЕК_ID IN
                               (SELECT ЧЕЛОВЕК_ЧЕЛОВЕК_ID
                                   FROM ИГРОК_КОМАНДЫ
                                  WHERE ИГРОК_КОМАНДЫ.КОМАНДА_КОМАНДА_ID =
                                        КОМАНДА_ID))
                            OR (ТИП_СОБЫТИ_ТИП_СОБЫТИ_ID = 2 AND
                               ЧЕЛОВЕК_ЧЕЛОВЕК_ID NOT IN
                               (SELECT ЧЕЛОВЕК_ЧЕЛОВЕК_ID
                                   FROM ИГРОК_КОМАНДЫ
                                  WHERE ИГРОК_КОМАНДЫ.КОМАНДА_КОМАНДА_ID =
                                        КОМАНДА_ID))))) >
               (SELECT COUNT(*)
                  FROM (SELECT *
                          FROM СОБЫТИЕ
                         WHERE МАТЧ_МАТЧ_ID = МАТЧ_ID
                           AND ((ТИП_СОБЫТИ_ТИП_СОБЫТИ_ID = 2 AND
                               ЧЕЛОВЕК_ЧЕЛОВЕК_ID IN
                               (SELECT ЧЕЛОВЕК_ЧЕЛОВЕК_ID
                                   FROM ИГРОК_КОМАНДЫ
                                  WHERE ИГРОК_КОМАНДЫ.КОМАНДА_КОМАНДА_ID =
                                        КОМАНДА_ID))
                            OR ((ТИП_СОБЫТИ_ТИП_СОБЫТИ_ID = 1 OR
                               ТИП_СОБЫТИ_ТИП_СОБЫТИ_ID = 4) AND
                               ЧЕЛОВЕК_ЧЕЛОВЕК_ID NOT IN
                               (SELECT ЧЕЛОВЕК_ЧЕЛОВЕК_ID
                                   FROM ИГРОК_КОМАНДЫ
                                  WHERE ИГРОК_КОМАНДЫ.КОМАНДА_КОМАНДА_ID =
                                        КОМАНДА_ID)))))) +
                (SELECT COUNT(*)
                  FROM МАТЧ
                 WHERE (SELECT COUNT(*)
                          FROM (SELECT *
                                  FROM СОБЫТИЕ
                                 WHERE МАТЧ_МАТЧ_ID = МАТЧ_ID
                                   AND (((ТИП_СОБЫТИ_ТИП_СОБЫТИ_ID = 1 OR
                                       ТИП_СОБЫТИ_ТИП_СОБЫТИ_ID = 4) AND
                                       ЧЕЛОВЕК_ЧЕЛОВЕК_ID IN
                                       (SELECT ЧЕЛОВЕК_ЧЕЛОВЕК_ID
                                           FROM ИГРОК_КОМАНДЫ
                                          WHERE ИГРОК_КОМАНДЫ.КОМАНДА_КОМАНДА_ID =
                                                КОМАНДА_ID))
                                    OR (ТИП_СОБЫТИ_ТИП_СОБЫТИ_ID = 2 AND
                                       ЧЕЛОВЕК_ЧЕЛОВЕК_ID NOT IN
                                       (SELECT ЧЕЛОВЕК_ЧЕЛОВЕК_ID
                                           FROM ИГРОК_КОМАНДЫ
                                          WHERE ИГРОК_КОМАНДЫ.КОМАНДА_КОМАНДА_ID =
                                                КОМАНДА_ID))))) =
                       (SELECT COUNT(*)
                          FROM (SELECT *
                                  FROM СОБЫТИЕ
                                 WHERE МАТЧ_МАТЧ_ID = МАТЧ_ID
                                   AND ((ТИП_СОБЫТИ_ТИП_СОБЫТИ_ID = 2 AND
                                       ЧЕЛОВЕК_ЧЕЛОВЕК_ID IN
                                       (SELECT ЧЕЛОВЕК_ЧЕЛОВЕК_ID
                                           FROM ИГРОК_КОМАНДЫ
                                          WHERE ИГРОК_КОМАНДЫ.КОМАНДА_КОМАНДА_ID =
                                                КОМАНДА_ID))
                                    OR ((ТИП_СОБЫТИ_ТИП_СОБЫТИ_ID = 1 OR
                                       ТИП_СОБЫТИ_ТИП_СОБЫТИ_ID = 4) AND
                                       ЧЕЛОВЕК_ЧЕЛОВЕК_ID NOT IN
                                       (SELECT ЧЕЛОВЕК_ЧЕЛОВЕК_ID
                                           FROM ИГРОК_КОМАНДЫ
                                          WHERE ИГРОК_КОМАНДЫ.КОМАНДА_КОМАНДА_ID =
                                                КОМАНДА_ID))))))) AS ОЧКИ
  FROM КОМАНДА
  ORDER BY ОЧКИ DESC